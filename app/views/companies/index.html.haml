%h1 Listing companies

%table
  %thead
    %tr
      %th Name
      %th Website
      %th Address
      %th Size
      %th Found Year
      %th Revenue
      %th Synopsis
      %th Realtors
      %th
      %th
      %th

  %tbody
    - @companies.each do |company|
      %tr
        %td= company.name
        %td= company.website
        %td= company.addr
        %td= company.size
        %td= company.found_year
        %td= "#{company.revenue} per year"
        %td= company.synopsis
        %td= company.owned_by
        %td= link_to 'Show', company
        - r = Realtor.for_user_company(current_user.id, company.id).first
        - if !r.nil? && r.is_owner?
          %td= link_to 'Edit', edit_compgiany_path(company)
        - if Realtor.find_by_user_id(current_user.id).nil? && current_user.realtor?
          %td= link_to 'Join', join_company_path(company)
        - if !r.nil? && !r.is_owner?
          %td= link_to 'Leave', leave_company_path(company)
        - if current_user.admin?
          %td= link_to 'Destroy', company, method: :delete, data: { confirm: 'Are you sure?' }

%br

= link_to 'New Company', new_company_path, :class => 'button-xs'
